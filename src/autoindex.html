<!DOCTYPE html>
<html>
<head>
<meta charset="$charset">
<meta http-equiv="Content-type" content="text/html; charset=$charset">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="author" content="Jack.Chan">
<meta name="email" content="fulicat@qq.com">
<style type="text/css">
.autoindex{
	font-family: Monaco, "Helvetica Neue", Helvetica, "PingFang SC", "Microsoft YaHei", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
	font-size: 14px;
	padding:0 10px;
}
.caption{
	word-break:break-all;
}
.list>li{
	line-height:34px;
	border-bottom:1px #ddd solid;
	padding-left:10px;
	padding-right:10px;
	position:relative;
	color:#999;
}
.list>li:hover{
	border-bottom-color:#2c66b1;
	background-color:#eee;
}
.list>li>a{
	text-decoration:none;
	display:inline-block;
	min-width:80px;
}
.list>li>a:hover{
	text-decoration:underline;
}
.item-info{
	position:absolute;
	top:0;
	right:0;
	bottom:0;
	display:block;
	color:#666;
}
.item-mtime,
.item-size{
	min-height:16px;
	height:100%;
	display:inline-block;
	vertical-align:top;
	background-color:#fdfdfd;
}
.list>li:hover .item-mtime,
.list>li:hover .item-size{
	background-color:#f7f7f7;
}
.item-mtime{
	min-width:160px;
	padding-left:10px;
	padding-right:2px;
}
.item-size{
	min-width:100px;
	padding-right:10px;
	text-align:right;
	padding-left:2px;
}

.item-icon,
.item-name{
	vertical-align:middle;
}
.item-icon{
	display:inline-block;
}
.item-name{
	display:inline;
	min-width:40px;
	min-height:20px;
	line-height:20px;
}

.copyright{
	text-align:right;
	padding:10px;
	color:#888;
	font-size:12px;
}
.copyright a{
	color:#2c66b1;
}

@media (max-width: 768px){
	.caption{
		font-size:16px;
	}
	.list>li{
		padding:5px;
		line-height:24px;
	}
	.list>li>a{
		display:block;
		white-space:normal;
		word-break:break-all;
		margin:-5px;
		padding:8px 5px;
	}
	.item-info{
		min-width:auto;
		position:static;
		font-size:12px;
		line-height:16px;
		color:#888;
		padding:0;
		width:100%;
		display:table;
		table-layout:fixed;
		border-collapse: collapse;
	}
	.item-mtime,
	.item-size{
		display:table-cell;
		padding-top:4px;
	}
	.item-mtime,
	.item-size,
	.list>li:hover .item-mtime,
	.list>li:hover .item-size{
		background-color:transparent;
	}
	.item-mtime{
		display:block;
		padding-left:0;
	}
	.item-size{
		min-width: auto;
		padding-right:0;
		text-align:left;
	}
	.item-mtime + .item-size{
		min-width: 100px;
		text-align:right;
	}
}
.item-icon{
	width:20px;
	height:20px;
	font-size:0;
	line-height:0;
	margin-right:5px;
	display:inline-block;
	background-repeat:no-repeat;
	background-size: 100% auto;
	background-position: center;
}
.item-icon.parent{
	background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIj4KICA8cGF0aCBmaWxsPSIjNTU1IiBkPSJNOSA0bC02IDYgNiA2IDEuNC0xLjRMNi44IDExSDE2VjlINi44bDMuNi0zLjZ6Ii8+Cjwvc3ZnPg==);
}
.item-icon.directory{
	background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIj4KICA8cGF0aCBmaWxsPSIjNTU1IiBkPSJNMiAzdjE0aDE2VjVoLThMOCAzeiIvPgo8L3N2Zz4=);
}
.item-icon.file{
	background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIj4KICA8cGF0aCBmaWxsPSIjNTU1IiBkPSJNMyAydjE2aDE0VjZsLTQtNHptMiAyaDdsMyAzdjlINXoiLz4KPC9zdmc+);
}
</style>
</head>
<body>
<div id="autoindex"></div>
<script>
(function() {
	var size = function(value) {
		var units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
		if( undefined == value || null == value || value == '') {
			return '0 '+units[0];
		};
		var index = 0;
		var srcsize = parseFloat(value);
		var index = Math.floor(Math.log(srcsize) / Math.log(1024));
		var size = srcsize/Math.pow(1024, index);
		size = size.toFixed(2).toString();
		if (size.substr(-3) === '.00') {
			size = size.substr(0, size.length -3);
		}
		return size+' '+units[index];
	};
	var render = function(data, opts) {
		// var opts = {mtime: true, size: true};
		var html = [];
		html.push('<h1 class="caption">'+ document.title +'</h1>');
		html.push('<ol class="list">');
		html.push('<li class="item-parent"><a href="../" title="parent"><i class="item-icon parent"></i><span class="item-name">..</span></a></li>');
		if (data && typeof(data) === 'object' && data.length) {
			for(var i = 0;i<data.length;i++) {
				if (data[i].name) {
					html.push('<li class="item-'+ data[i].type +'">');
					html.push('<a href="'+ data[i].name +'" title="'+ data[i].name +'"><i class="item-icon '+ data[i].type +'"></i><span class="item-name">'+ data[i].name +'</span></a>');
					if (typeof(opts) === 'object' && (opts.mtime || opts.size)) {
						html.push('<span class="item-info">');
						if (opts.mtime && data[i].mtime !== undefined) {
							html.push('<small class="item-mtime">'+ (new Date(data[i].mtime)).toLocaleString(undefined, {hour12: false}) +'</small>');
						};
						if (opts.size) {
							html.push('<small class="item-size">'+ (data[i].size !== undefined ? size(data[i].size) : '-') +'</small>');
						};
						html.push('</span>');
					};
					html.push('</li>');
				};
			};
		};
		html.push('</ol>');
		html.push('<p class="copyright">');
		html.push('<span>autoindex for nginx</span>&nbsp;&copy;&nbsp;<a target="_blank" href="http://fulicat.com">fulicat.com</a>');
		html.push('</p>');
		return html.join('');
	};
	document.title = 'Index of '+ decodeURIComponent(location.pathname);
	var app = document.getElementById('autoindex');
	app.setAttribute('class', 'autoindex');
	app.innerHTML = render([{}], {});
})();
</script>
</body>
</html>